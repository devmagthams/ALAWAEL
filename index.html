<!DOCTYPE html>
<html lang="ar" dir="rtl">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Ø¹Ø±Ø¶ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø·Ù„Ø§Ø¨</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

    <style>
      @import url("https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700&display=swap");

      body {
        font-family: "Tajawal", sans-serif;
        background: linear-gradient(to bottom, #e0f2fe, #ffffff);
        padding: 30px;
        color: #1f2937;
        overflow-x: hidden;
      }

      h1 {
        text-align: center;
        color: #0f172a;
        margin-bottom: 10px;
        font-size: 24px;
        text-shadow: 1px 1px 2px #cbd5e1;
      }

      .file-container {
        max-width: 600px;
        margin: 0 auto 30px;
        background-color: white;
        padding: 20px;
        border-radius: 15px;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
        text-align: center;
      }

      .file-input-wrapper {
        position: relative;
        margin: 20px auto;
        width: 80%;
        overflow: hidden;
      }

      .file-input {
        position: absolute;
        font-size: 100px;
        opacity: 0;
        right: 0;
        top: 0;
        cursor: pointer;
        height: 100%;
        width: 100%;
        z-index: 2;
      }

      .file-input-button {
        display: block;
        padding: 15px 30px;
        background: linear-gradient(90deg, #3b82f6, #1d4ed8);
        color: white;
        border: none;
        border-radius: 10px;
        cursor: pointer;
        font-size: 16px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        transition: all 0.3s ease;
        text-align: center;
        margin: 0 auto;
      }

      .file-input-button:hover {
        background: linear-gradient(90deg, #1d4ed8, #3b82f6);
        transform: translateY(-2px);
      }

      .file-input-label {
        display: block;
        margin: 10px 0;
        color: #6b7280;
        font-size: 14px;
      }

      .template-btn {
        display: inline-block;
        margin: 10px auto;
        padding: 10px 20px;
        background: #f8fafc;
        color: #334155;
        border: 1px solid #cbd5e1;
        border-radius: 8px;
        cursor: pointer;
        font-size: 14px;
        text-decoration: none;
        transition: all 0.3s ease;
      }

      .template-btn:hover {
        background: #e2e8f0;
        color: #0f172a;
      }

      h2 {
        background: linear-gradient(to right, #2563eb, #1e3a8a);
        color: white;
        padding: 14px;
        border-radius: 12px;
        margin-top: 40px;
        box-shadow: 0 3px 8px rgba(0, 0, 0, 0.1);
        text-align: center;
        font-size: 24px;
      }

      .card-container {
        display: flex;
        justify-content: center;
        gap: 20px;
        flex-wrap: wrap;
        margin-top: 25px;
        padding: 10px;
      }

      .card {
        height: 100px;
        background: #ffffff;
        border: 2px solid #e2e8f0;
        border-radius: 15px;
        padding: 20px;
        text-align: center;
        box-shadow: 0 6px 16px rgba(0, 0, 0, 0.06);
        transition: transform 0.3s, box-shadow 0.3s;
        min-width: 250px;
      }

      .card:hover {
        transform: translateY(-7px);
        box-shadow: 0 8px 20px rgba(0, 0, 0, 0.08);
      }

      .card.gold {
        width: 28%;
        border-color: #ffcc00;
        position: relative;
        padding: 20px;
        border-radius: 16px;
        background: rgba(255, 255, 255, 0.1);
        color: #fff;
        z-index: 1;
        overflow: hidden;
        backdrop-filter: blur(8px);
        -webkit-backdrop-filter: blur(8px);
        box-shadow: 0 0 20px rgba(255, 215, 0, 0.3);
      }

      .card.gold::before {
        content: "ğŸ¥‡ ";
        font-size: 60px;
        position: absolute;
        top: -3px;
        right: -3px;
        bottom: -3px;
        left: -3px;
        background: linear-gradient(145deg, #ffd700, #fff8dc, #ffcc00);
        border-radius: 18px;
        z-index: -1;
        filter: blur(3px);
        opacity: 0.8;
      }

      .card.silver {
        width: 28%;
        font-size: 60px;
        border-color: #7b7b7b;
        position: relative;
        padding: 20px;
        border-radius: 16px;
        background: rgba(255, 255, 255, 0.08);
        color: #fff;
        z-index: 1;
        overflow: hidden;
        backdrop-filter: blur(8px);
        -webkit-backdrop-filter: blur(8px);
        box-shadow: 0 0 20px rgba(192, 192, 192, 0.3);
      }

      .card.silver::before {
        content: "ğŸ¥ˆ ";
        font-size: 60px;
        position: absolute;
        top: -3px;
        right: -3px;
        bottom: -3px;
        left: -3px;
        background: linear-gradient(135deg, #c0c0c0, #e0e0e0, #f5f5f5);
        border-radius: 18px;
        z-index: -1;
        filter: blur(3px);
        opacity: 0.8;
      }

      .card.bronze {
        width: 28%;
        font-size: 60px;
        border-color: #cd7f32;
        position: relative;
        padding: 20px;
        border-radius: 16px;
        background: rgba(255, 255, 255, 0.07);
        color: #fff;
        z-index: 1;
        overflow: hidden;
        backdrop-filter: blur(8px);
        -webkit-backdrop-filter: blur(8px);
        box-shadow: 0 0 20px rgba(233, 150, 68, 0.149);
      }

      .card.bronze::before {
        content: "ğŸ¥‰";
        position: absolute;
        top: -3px;
        right: -3px;
        bottom: -3px;
        left: -3px;
        background: linear-gradient(135deg, #cd7f32, #b87333, #deb887);
        border-radius: 18px;
        z-index: -1;
        filter: blur(3px);
        opacity: 0.85;
      }

      .rank {
        font-size: 30px;
        font-weight: bold;
        color: #ff0000;
        text-shadow: #f5f116 1px 1px 2px;
      }

      .name {
        font-size: 20px;
        margin-top: 8px;
        font-weight: bold;
        color: #111827;
      }

      .score {
        font-size: 16px;
        font-weight: bold;
        margin-top: 10px;
        color: #374151;
      }

      .controls {
        display: flex;
        flex-direction: column;
        gap: 15px;
        position: fixed;
        top: 50%;
        right: 20px;
        transform: translateY(-50%);
        z-index: 100;
        background-color: rgba(255, 255, 255, 0.8);
        padding: 15px;
        border-radius: 10px;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        transition: opacity 0.5s ease;
      }

      .btn {
        padding: 10px 15px;
        background: #3b82f6;
        color: white;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        font-family: "Tajawal", sans-serif;
        font-size: 16px;
        transition: background 0.3s;
        width: 160px;
        text-align: center;
      }

      .btn:hover {
        background: #1d4ed8;
      }

      .hidden {
        display: none !important;
      }

      .fade-out {
        opacity: 0;
        pointer-events: none;
      }

      @media (max-width: 768px) {
        .card {
          min-width: 200px;
        }
      }

      #logo {
        display: flex;
        justify-content: center;
        font-size: 30px;
        text-shadow: #2563eb 1px 1px 2px;
        margin-top: 30px;
      }

      /* Ù‚Ø§Ù„Ø¨ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ */
      .template-modal,
      .settings-modal {
        display: none;
        position: fixed;
        top: 0;
        right: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.7);
        z-index: 1000;
        overflow-y: auto;
      }

      .template-content,
      .settings-content {
        background-color: white;
        max-width: 800px;
        width: 90%;
        margin: 50px auto;
        padding: 30px;
        border-radius: 15px;
        box-shadow: 0 4px 30px rgba(0, 0, 0, 0.2);
        position: relative;
        max-height: 80vh;
        overflow-y: auto;
      }

      .settings-form {
        display: flex;
        flex-direction: column;
        gap: 20px;
        margin-top: 25px;
      }

      .form-group {
        display: flex;
        flex-direction: column;
        gap: 8px;
      }

      .form-group label {
        font-weight: bold;
        color: #334155;
      }

      .form-group input {
        padding: 12px 15px;
        border: 1px solid #cbd5e1;
        border-radius: 8px;
        font-family: "Tajawal", sans-serif;
        font-size: 16px;
        color: #334155;
      }

      .form-group input:focus {
        outline: none;
        border-color: #3b82f6;
        box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.2);
      }

      .settings-btn {
        display: flex;
        align-items: center;
        gap: 8px;
        padding: 8px 16px;
        background: #f1f5f9;
        color: #334155;
        border: 1px solid #cbd5e1;
        border-radius: 8px;
        cursor: pointer;
        font-size: 14px;
        transition: all 0.3s ease;
        position: fixed;
        bottom: 20px;
        right: 20px;
      }

      .settings-btn:hover {
        background: #e2e8f0;
        color: #0f172a;
      }

      .settings-btn svg {
        width: 18px;
        height: 18px;
      }

      .save-settings-btn {
        display: block;
        margin: 30px auto 0;
        padding: 12px 25px;
        background: linear-gradient(90deg, #3b82f6, #1d4ed8);
        color: white;
        border: none;
        border-radius: 10px;
        cursor: pointer;
        font-family: "Tajawal", sans-serif;
        font-size: 16px;
        transition: all 0.3s ease;
      }

      .save-settings-btn:hover {
        background: linear-gradient(90deg, #1d4ed8, #3b82f6);
        transform: translateY(-2px);
      }

      .close-btn {
        position: absolute;
        top: 15px;
        left: 15px;
        font-size: 24px;
        cursor: pointer;
        color: #64748b;
        transition: color 0.3s;
        background: none;
        border: none;
        width: 40px;
        height: 40px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .close-btn:hover {
        color: #ef4444;
        background-color: #f1f5f9;
      }

      .template-title {
        text-align: center;
        color: #0f172a;
        margin-bottom: 20px;
        font-size: 24px;
      }

      .template-section {
        margin-bottom: 25px;
        padding: 15px;
        border-radius: 10px;
        background-color: #f8fafc;
        border-right: 5px solid #3b82f6;
      }

      .template-section h3 {
        color: #1e40af;
        font-size: 18px;
        margin-bottom: 10px;
      }

      .template-table {
        width: 100%;
        border-collapse: collapse;
        margin: 15px 0;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
        border-radius: 8px;
        overflow: hidden;
      }

      .template-table th,
      .template-table td {
        padding: 10px 12px;
        text-align: right;
        border-bottom: 1px solid #e2e8f0;
      }

      .template-table thead {
        background-color: #3b82f6;
        color: white;
      }

      .template-table tbody tr:nth-child(even) {
        background-color: #f1f5f9;
      }

      .download-template-btn {
        display: block;
        width: 250px;
        margin: 20px auto;
        padding: 12px 20px;
        background: linear-gradient(90deg, #3b82f6, #1d4ed8);
        color: white;
        border: none;
        border-radius: 10px;
        cursor: pointer;
        font-family: "Tajawal", sans-serif;
        font-size: 16px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        transition: all 0.3s ease;
        text-align: center;
      }

      .download-template-btn:hover {
        background: linear-gradient(90deg, #1d4ed8, #3b82f6);
        transform: translateY(-3px);
      }

      .alert {
        padding: 12px;
        border-radius: 8px;
        margin-top: 15px;
        font-size: 14px;
        text-align: center;
        display: none;
      }

      .alert-success {
        background-color: #ecfdf5;
        color: #047857;
        border: 1px solid #10b981;
        display: block;
      }

      .alert-error {
        background-color: #fef2f2;
        color: #b91c1c;
        border: 1px solid #ef4444;
        display: block;
      }

      .reset-btn {
        display: inline-block;
        margin: 20px auto;
        padding: 10px 20px;
        background: #f1f5f9;
        color: #475569;
        border: 1px solid #cbd5e1;
        border-radius: 8px;
        cursor: pointer;
        font-size: 14px;
        text-decoration: none;
        transition: all 0.3s ease;
        position: fixed;
        bottom: 20px;
        left: 20px;
      }

      .reset-btn:hover {
        background: #e2e8f0;
        color: #0f172a;
      }

      .file-help {
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 5px;
        font-size: 14px;
        color: #64748b;
        margin-top: 15px;
      }

      .file-help svg {
        width: 18px;
        height: 18px;
      }
    </style>
  </head>
  <body>
    <h1>Ø±ØµÙŠØ¯ Ø§Ù„Ù†Ù‚Ø§Ø·</h1>

    <div class="file-container">
      <div class="file-input-wrapper">
        <button class="file-input-button">Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ù…Ù„Ù Ø§Ù„Ø¥ÙƒØ³Ù„</button>
        <input type="file" id="excelFile" accept=".xlsx" class="file-input" />
      </div>
      <div class="file-input-label">Ù‚Ù… Ø¨Ø§Ø®ØªÙŠØ§Ø± Ù…Ù„Ù Ø¥ÙƒØ³Ù„ Ø¨ØµÙŠØºØ© (.xlsx)</div>
      <div class="file-help">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          fill="none"
          viewBox="0 0 24 24"
          stroke="currentColor"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"
          />
        </svg>
        <span>Ù„Ø§ ØªÙ…Ù„Ùƒ Ø§Ù„Ù…Ù„ÙØŸ</span>
        <a href="#" id="showTemplateBtn" class="template-btn"
          >Ø¹Ø±Ø¶ Ø§Ù„Ù‚Ø§Ù„Ø¨ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ÙŠ</a
        >
      </div>
      <div id="fileAlert" class="alert"></div>
    </div>

    <div id="controls" class="controls hidden">
      <button id="prevBtn" class="btn">Ø§Ù„Ø³Ø§Ø¨Ù‚</button>
      <button id="nextBtn" class="btn">Ø§Ù„ØªØ§Ù„ÙŠ</button>
      <button id="autoBtn" class="btn">Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ø¹Ø±Ø¶ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ</button>
    </div>

    <div id="output"></div>
    <div id="logo">" Ù‡Ù†Ø§ ÙŠØªÙ„Ù‰ Ø§Ù„Ù‚Ø±Ø¢Ù† .. Ùˆ ÙŠÙ†Ø³Ø¬ Ø§Ù„Ù…Ø¬Ø¯ Ø­Ø±ÙØ§Ù‹ Ø­Ø±ÙØ§Ù‹ "</div>

    <button id="resetBtn" class="reset-btn hidden">ØªØ­Ù…ÙŠÙ„ Ù…Ù„Ù Ø¬Ø¯ÙŠØ¯</button>

    <!-- ØªØºÙŠÙŠØ± - Ø¬Ø¹Ù„ Ø²Ø± Ø§Ù„ØªØ®ØµÙŠØµ Ù…Ø®ÙÙŠ Ø¨Ø´ÙƒÙ„ Ø§ÙØªØ±Ø§Ø¶ÙŠ -->
    <button id="settingsBtn" class="settings-btn hidden">
      <svg
        xmlns="http://www.w3.org/2000/svg"
        fill="none"
        viewBox="0 0 24 24"
        stroke="currentColor"
      >
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"
        />
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"
        />
      </svg>
      ØªØ®ØµÙŠØµ
    </button>

    <!-- Ù‚Ø§Ù„Ø¨ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ -->
    <div id="templateModal" class="template-modal">
      <div class="template-content">
        <button class="close-btn" id="closeTemplateBtn">Ã—</button>
        <h2 class="template-title">Ù‚Ø§Ù„Ø¨ Ù…Ù„Ù Ø±ØµÙŠØ¯ Ø§Ù„Ù†Ù‚Ø§Ø·</h2>

        <div class="template-section">
          <h3>
            <span
              style="
                display: inline-block;
                width: 25px;
                height: 25px;
                background-color: #3b82f6;
                color: white;
                border-radius: 50%;
                text-align: center;
                margin-left: 8px;
              "
              >1</span
            >
            ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ù…Ù„Ù
          </h3>
          <p>ÙŠØ¬Ø¨ Ø£Ù† ÙŠØ­ØªÙˆÙŠ Ù…Ù„Ù Ø§Ù„Ø¥ÙƒØ³Ù„ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ø¹Ù…Ø¯Ø© Ø§Ù„ØªØ§Ù„ÙŠØ© Ø¨Ø§Ù„Ø¶Ø¨Ø·:</p>
          <table class="template-table">
            <thead>
              <tr>
                <th id="groupColumnHeader">Ø§Ù„Ø­Ù„Ù‚Ø©</th>
                <th>Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨</th>
                <th>Ø§Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø±ØµÙŠØ¯</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td id="groupColumnExample">Ø§Ù„Ø­Ù„Ù‚Ø© 1</td>
                <td>Ù…Ø­Ù…Ø¯ Ø£Ø­Ù…Ø¯ Ø¹Ù„ÙŠ</td>
                <td>85</td>
              </tr>
            </tbody>
          </table>
        </div>

        <div class="template-section">
          <h3>
            <span
              style="
                display: inline-block;
                width: 25px;
                height: 25px;
                background-color: #3b82f6;
                color: white;
                border-radius: 50%;
                text-align: center;
                margin-left: 8px;
              "
              >2</span
            >
            Ù…Ø«Ø§Ù„ Ø¹Ù„Ù‰ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
          </h3>
          <p>ÙÙŠÙ…Ø§ ÙŠÙ„ÙŠ Ù…Ø«Ø§Ù„ Ø¹Ù„Ù‰ ÙƒÙŠÙÙŠØ© ØªÙ†Ø¸ÙŠÙ… Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙÙŠ Ù…Ù„Ù Ø§Ù„Ø¥ÙƒØ³Ù„:</p>
          <table class="template-table">
            <thead>
              <tr>
                <th id="groupColumnHeader2">Ø§Ù„Ø­Ù„Ù‚Ø©</th>
                <th>Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨</th>
                <th>Ø§Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø±ØµÙŠØ¯</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td id="groupColumnExample2">Ø§Ù„Ø­Ù„Ù‚Ø© 1</td>
                <td>Ø®Ø§Ù„Ø¯ Ù…Ø­Ù…Ø¯</td>
                <td>95</td>
              </tr>
              <tr>
                <td id="groupColumnExample3">Ø§Ù„Ø­Ù„Ù‚Ø© 1</td>
                <td>Ø¹Ù„ÙŠ Ø£Ø­Ù…Ø¯</td>
                <td>85</td>
              </tr>
              <tr>
                <td id="groupColumnExample4">Ø§Ù„Ø­Ù„Ù‚Ø© 2</td>
                <td>Ù…Ø­Ù…Ø¯ Ø¹Ù„ÙŠ</td>
                <td>91</td>
              </tr>
            </tbody>
          </table>
          <p style="color: #64748b; font-size: 14px">
            Ù…Ù„Ø§Ø­Ø¸Ø©: ØªØ£ÙƒØ¯ Ù…Ù† ÙƒØªØ§Ø¨Ø© Ø£Ø³Ù…Ø§Ø¡ Ø§Ù„Ø£Ø¹Ù…Ø¯Ø© Ø¨Ø§Ù„Ø¶Ø¨Ø· ÙƒÙ…Ø§ Ù‡Ùˆ Ù…ÙˆØ¶Ø­ Ø£Ø¹Ù„Ø§Ù‡.
          </p>
        </div>

        <button id="downloadTemplateBtn" class="download-template-btn">
          ØªÙ†Ø²ÙŠÙ„ Ù…Ù„Ù Ø§Ù„Ù‚Ø§Ù„Ø¨
        </button>
      </div>
    </div>

    <!-- Ù†Ø§ÙØ°Ø© Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª -->
    <div id="settingsModal" class="settings-modal">
      <div class="settings-content">
        <button class="close-btn" id="closeSettingsBtn">Ã—</button>
        <h2 class="template-title">Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„ØªØ®ØµÙŠØµ</h2>

        <div class="settings-form">
          <div class="form-group">
            <label for="groupNameInput">Ø§Ø³ØªØ¨Ø¯Ø§Ù„ ÙƒÙ„Ù…Ø© "Ø§Ù„Ø­Ù„Ù‚Ø©" Ø¨Ù€:</label>
            <input
              type="text"
              id="groupNameInput"
              placeholder="Ù…Ø«Ø§Ù„: Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø©ØŒ Ø§Ù„ÙØµÙ„ØŒ Ø§Ù„Ø¯ÙØ¹Ø©..."
              value="Ø§Ù„Ø­Ù„Ù‚Ø©"
            />
            <small style="color: #64748b"
              >Ø³ÙŠØªÙ… Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù‡Ø°Ø§ Ø§Ù„Ù…Ø³Ù…Ù‰ ÙÙŠ ÙƒÙ„ Ù…ÙƒØ§Ù† ÙŠØ¸Ù‡Ø± ÙÙŠÙ‡ "Ø§Ù„Ø­Ù„Ù‚Ø©"</small
            >
          </div>

          <div class="form-group">
            <label for="mottoInput">Ø§Ù„Ø¹Ø¨Ø§Ø±Ø© Ø§Ù„Ø¥ÙŠÙ‚ÙˆÙ†ÙŠØ©:</label>
            <input
              type="text"
              id="mottoInput"
              placeholder="Ø´Ø¹Ø§Ø± Ø£Ùˆ Ø¹Ø¨Ø§Ø±Ø© Ø§Ù„Ù…ÙˆÙ‚Ø¹..."
              value="Ù‡Ù†Ø§ ÙŠØªÙ„Ù‰ Ø§Ù„Ù‚Ø±Ø¢Ù† .. Ùˆ ÙŠÙ†Ø³Ø¬ Ø§Ù„Ù…Ø¬Ø¯ Ø­Ø±ÙØ§Ù‹ Ø­Ø±ÙØ§Ù‹"
            />
            <small style="color: #64748b">Ù‡Ø°Ù‡ Ø§Ù„Ø¹Ø¨Ø§Ø±Ø© Ø³ØªØ¸Ù‡Ø± Ø£Ø³ÙÙ„ Ø§Ù„ØµÙØ­Ø©</small>
          </div>
        </div>

        <button id="saveSettingsBtn" class="save-settings-btn">
          Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª
        </button>
      </div>
    </div>

    <script>
      // Ø§Ù„Ø¹Ù†Ø§ØµØ± Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
      const fileInput = document.getElementById("excelFile");
      const outputDiv = document.getElementById("output");
      const controlsDiv = document.getElementById("controls");
      const prevBtn = document.getElementById("prevBtn");
      const nextBtn = document.getElementById("nextBtn");
      const autoBtn = document.getElementById("autoBtn");
      const fileAlert = document.getElementById("fileAlert");
      const showTemplateBtn = document.getElementById("showTemplateBtn");
      const templateModal = document.getElementById("templateModal");
      const closeTemplateBtn = document.getElementById("closeTemplateBtn");
      const downloadTemplateBtn = document.getElementById(
        "downloadTemplateBtn"
      );
      const resetBtn = document.getElementById("resetBtn");
      const logoDiv = document.getElementById("logo");
      const settingsBtn = document.getElementById("settingsBtn");
      const settingsModal = document.getElementById("settingsModal");
      const closeSettingsBtn = document.getElementById("closeSettingsBtn");
      const groupNameInput = document.getElementById("groupNameInput");
      const mottoInput = document.getElementById("mottoInput");
      const saveSettingsBtn = document.getElementById("saveSettingsBtn");

      // Ø¹Ù†Ø§ØµØ± Ø¹Ø±Ø¶ Ø§Ø³Ù… Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø© ÙÙŠ Ø§Ù„Ù‚Ø§Ù„Ø¨
      const groupColumnHeaders = document.querySelectorAll(
        '[id^="groupColumnHeader"]'
      );
      const groupColumnExamples = document.querySelectorAll(
        '[id^="groupColumnExample"]'
      );

      // Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø©
      let groups = {};
      let episodes = [];
      let currentIndex = 0;
      let intervalId = null;
      let autoPlay = true;
      let mouseTimer = null;
      let groupColumnName = "Ø§Ù„Ø­Ù„Ù‚Ø©"; // Ø§Ø³Ù… Ø¹Ù…ÙˆØ¯ Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø§Øª Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ
      let motto = "Ù‡Ù†Ø§ ÙŠØªÙ„Ù‰ Ø§Ù„Ù‚Ø±Ø¢Ù† .. Ùˆ ÙŠÙ†Ø³Ø¬ Ø§Ù„Ù…Ø¬Ø¯ Ø­Ø±ÙØ§Ù‹ Ø­Ø±ÙØ§Ù‹"; // Ø§Ù„Ø¹Ø¨Ø§Ø±Ø© Ø§Ù„Ø¥ÙŠÙ‚ÙˆÙ†ÙŠØ© Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ©

      // Ù…Ø³Ø­ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
      clearLocalStorage();

      // Ø§Ø³ØªÙ…Ø§Ø¹ Ù„Ø­Ø¯Ø« ØªØºÙŠÙŠØ± Ø§Ù„Ù…Ù„Ù
      fileInput.addEventListener("change", handleFile);
      prevBtn.addEventListener("click", showPrevious);
      nextBtn.addEventListener("click", showNext);
      autoBtn.addEventListener("click", toggleAuto);
      showTemplateBtn.addEventListener("click", showTemplate);
      closeTemplateBtn.addEventListener("click", closeTemplate);
      downloadTemplateBtn.addEventListener("click", downloadTemplate);
      resetBtn.addEventListener("click", resetApplication);
      settingsBtn.addEventListener("click", showSettings);
      closeSettingsBtn.addEventListener("click", closeSettings);
      saveSettingsBtn.addEventListener("click", saveSettings);

      // Ø¥Ø¶Ø§ÙØ© Ù…Ø±Ø§Ù‚Ø¨ÙŠ Ø­Ø±ÙƒØ© Ø§Ù„ÙØ£Ø±Ø©
      document.addEventListener("mousemove", handleMouseMove);

      // Ø¯Ø§Ù„Ø© Ù…Ø³Ø­ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Ø§Ù„ØªØ®Ø²ÙŠÙ† Ø§Ù„Ù…Ø­Ù„ÙŠ
      function clearLocalStorage() {
        // Ù…Ø³Ø­ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„ØªØ®ØµÙŠØµ Ù…Ù† Ø§Ù„ØªØ®Ø²ÙŠÙ† Ø§Ù„Ù…Ø­Ù„ÙŠ
        localStorage.removeItem("studentScoreSettings");
        console.log("ØªÙ… Ù…Ø³Ø­ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Ø§Ù„ØªØ®Ø²ÙŠÙ† Ø§Ù„Ù…Ø­Ù„ÙŠ");
      }

      // Ø¯Ø§Ù„Ø© Ù…Ø¹Ø§Ù„Ø¬Ø© Ø­Ø±ÙƒØ© Ø§Ù„ÙØ£Ø±Ø©
      function handleMouseMove() {
        // Ø¥Ø¸Ù‡Ø§Ø± Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ­ÙƒÙ… Ø¹Ù†Ø¯ ØªØ­Ø±ÙŠÙƒ Ø§Ù„ÙØ£Ø±Ø©
        controlsDiv.classList.remove("fade-out");

        // Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ù…Ø¤Ù‚Øª Ø§Ù„Ø³Ø§Ø¨Ù‚ Ø¥Ù† ÙˆØ¬Ø¯
        if (mouseTimer) {
          clearTimeout(mouseTimer);
        }

        // ØªØ¹ÙŠÙŠÙ† Ù…Ø¤Ù‚Øª Ø¬Ø¯ÙŠØ¯ Ù„Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø£Ø²Ø±Ø§Ø± Ø¨Ø¹Ø¯ 3 Ø«ÙˆØ§Ù†Ù
        mouseTimer = setTimeout(() => {
          if (!controlsDiv.classList.contains("hidden")) {
            controlsDiv.classList.add("fade-out");
          }
        }, 3000);
      }

      // Ø¯Ø§Ù„Ø© Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ù…Ù„Ù
      function handleFile(e) {
        const file = e.target.files[0];
        if (!file) return;

        const reader = new FileReader();

        reader.onload = function (e) {
          try {
            const data = new Uint8Array(e.target.result);
            const workbook = XLSX.read(data, { type: "array" });
            const sheetName = workbook.SheetNames[0];
            const sheet = workbook.Sheets[sheetName];
            const jsonData = XLSX.utils.sheet_to_json(sheet);

            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ø§Ù„Ø£Ø¹Ù…Ø¯Ø© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©
            if (jsonData.length > 0) {
              const firstRow = jsonData[0];
              if (
                !firstRow[groupColumnName] ||
                !firstRow["Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨"] ||
                firstRow["Ø§Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø±ØµÙŠØ¯"] === undefined
              ) {
                showAlert(
                  `Ø®Ø·Ø£: ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù† Ø§Ù„Ù…Ù„Ù ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ø¹Ù…Ø¯Ø© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© (${groupColumnName}ØŒ Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨ØŒ Ø§Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø±ØµÙŠØ¯)`,
                  "error"
                );
                return;
              }
            } else {
              showAlert("Ø®Ø·Ø£: Ø§Ù„Ù…Ù„Ù Ù„Ø§ ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø¨ÙŠØ§Ù†Ø§Øª", "error");
              return;
            }

            // ØªØ¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø­Ø³Ø¨ Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø© (Ø§Ù„Ø­Ù„Ù‚Ø©)
            groups = {};
            jsonData.forEach((row) => {
              const group = row[groupColumnName] || "ØºÙŠØ± Ù…Ø­Ø¯Ø¯";
              if (!groups[group]) groups[group] = [];
              groups[group].push(row);
            });

            // ØªØ±ØªÙŠØ¨ Ø§Ù„Ù…ÙØ§ØªÙŠØ­
            episodes = Object.keys(groups).sort((a, b) =>
              a.localeCompare(b, "ar")
            );
            currentIndex = 0;

            // Ø¥Ø®ÙØ§Ø¡ Ø®Ø§Ù†Ø© Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„Ù…Ù„Ù
            document.querySelector(".file-container").classList.add("hidden");

            // Ø¥Ø¸Ù‡Ø§Ø± Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ­ÙƒÙ…
            controlsDiv.classList.remove("hidden");
            resetBtn.classList.remove("hidden");

            // ØªØºÙŠÙŠØ± - Ø¥Ø¸Ù‡Ø§Ø± Ø²Ø± Ø§Ù„ØªØ®ØµÙŠØµ Ø¨Ø¹Ø¯ Ø§Ù„Ø§Ø³ØªÙŠØ±Ø§Ø¯
            settingsBtn.classList.remove("hidden");

            // ØªÙØ¹ÙŠÙ„ Ù…Ø¤Ù‚Øª Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø£Ø²Ø±Ø§Ø±
            handleMouseMove();

            // Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰
            showCurrentGroup();

            // Ø¨Ø¯Ø¡ Ø§Ù„Ø¹Ø±Ø¶ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ
            startAutoPlay();

            // Ø¥Ø¸Ù‡Ø§Ø± Ø±Ø³Ø§Ù„Ø© Ù†Ø¬Ø§Ø­
            showAlert("ØªÙ… Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„Ù…Ù„Ù Ø¨Ù†Ø¬Ø§Ø­", "success");
          } catch (error) {
            showAlert("Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ù…Ù„Ù: " + error.message, "error");
          }
        };

        reader.readAsArrayBuffer(file);
      }

      // Ø¯Ø§Ù„Ø© Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ©
      function showCurrentGroup() {
        if (episodes.length === 0) return;

        const episode = episodes[currentIndex];
        const students = groups[episode];

        // ØªØ±ØªÙŠØ¨ Ø§Ù„Ø·Ù„Ø§Ø¨ Ø­Ø³Ø¨ Ø§Ù„Ø±ØµÙŠØ¯
        students.sort(
          (a, b) => (b["Ø§Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø±ØµÙŠØ¯"] || 0) - (a["Ø§Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø±ØµÙŠØ¯"] || 0)
        );

        // Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø¹Ù†Ø§ØµØ±
        outputDiv.innerHTML = "";

        const title = document.createElement("h2");
        title.innerHTML = `${groupColumnName}: ${episode}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(Ø¹Ø¯Ø¯ Ø§Ù„Ø·Ù„Ø§Ø¨: ${students.length})`;
        outputDiv.appendChild(title);

        const container = document.createElement("div");
        container.className = "card-container";

        // Ù…ØªØºÙŠØ±Ø§Øª Ù„ØªØªØ¨Ø¹ Ø§Ù„ØªØ±ØªÙŠØ¨
        let currentRank = 1; // Ø§Ù„Ù…Ø±ÙƒØ² Ø§Ù„Ø­Ø§Ù„ÙŠ
        let previousScore = null;
        let sameRankCount = 0; // Ø¹Ø¯Ø¯ Ø§Ù„Ø·Ù„Ø§Ø¨ ÙÙŠ Ù†ÙØ³ Ø§Ù„Ù…Ø±ÙƒØ²

        students.forEach((student, index) => {
          const currentScore = student["Ø§Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø±ØµÙŠØ¯"] || 0;

          // ØªØ­Ø¯ÙŠØ¯ Ø§Ù„ØªØ±ØªÙŠØ¨
          if (index === 0) {
            // Ø£ÙˆÙ„ Ø·Ø§Ù„Ø¨ Ø¯Ø§Ø¦Ù…Ø§Ù‹ ÙÙŠ Ø§Ù„Ù…Ø±ÙƒØ² Ø§Ù„Ø£ÙˆÙ„
            currentRank = 1;
            sameRankCount = 0;
          } else if (currentScore === previousScore) {
            // Ù†ÙØ³ Ø±ØµÙŠØ¯ Ø§Ù„Ø·Ø§Ù„Ø¨ Ø§Ù„Ø³Ø§Ø¨Ù‚ØŒ Ù†Ø³ØªØ®Ø¯Ù… Ù†ÙØ³ Ø§Ù„Ù…Ø±ÙƒØ²
            sameRankCount++;
          } else {
            // Ø±ØµÙŠØ¯ Ù…Ø®ØªÙ„ÙØŒ Ù†Ù†ØªÙ‚Ù„ Ù„Ù„Ù…Ø±ÙƒØ² Ø§Ù„ØªØ§Ù„ÙŠ (Ø¨ØºØ¶ Ø§Ù„Ù†Ø¸Ø± Ø¹Ù† Ø¹Ø¯Ø¯ Ø§Ù„Ù…ØªØ³Ø§ÙˆÙŠÙ†)
            currentRank = index + 1 - sameRankCount;
          }

          previousScore = currentScore;

          const card = document.createElement("div");
          card.className = "card";

          // Ø¥Ø¶Ø§ÙØ© ÙØ¦Ø© Ø­Ø³Ø¨ Ø§Ù„Ù…Ø±ÙƒØ²
          if (currentRank === 1) card.classList.add("gold");
          else if (currentRank === 2) card.classList.add("silver");
          else if (currentRank === 3) card.classList.add("bronze");

          const rank = document.createElement("div");
          rank.className = "rank";
          rank.textContent = ` ğŸ…    ${currentRank}   ğŸ…`;

          const name = document.createElement("div");
          name.className = "name";
          name.textContent = student["Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨"] || "-";

          const score = document.createElement("div");
          score.className = "score";
          score.textContent = `Ø§Ù„Ø±ØµÙŠØ¯: ${currentScore}`;

          card.appendChild(rank);
          card.appendChild(name);
          card.appendChild(score);
          container.appendChild(card);
        });

        outputDiv.appendChild(container);
      }

      // Ø¯Ø§Ù„Ø© Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø© Ø§Ù„ØªØ§Ù„ÙŠØ©
      function showNext() {
        if (episodes.length === 0) return;

        currentIndex = (currentIndex + 1) % episodes.length;
        showCurrentGroup();
      }

      // Ø¯Ø§Ù„Ø© Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø© Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©
      function showPrevious() {
        if (episodes.length === 0) return;

        currentIndex = (currentIndex - 1 + episodes.length) % episodes.length;
        showCurrentGroup();
      }

      // Ø¯Ø§Ù„Ø© Ø¨Ø¯Ø¡ Ø§Ù„Ø¹Ø±Ø¶ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ
      function startAutoPlay() {
        // Ø¥ÙŠÙ‚Ø§Ù Ø£ÙŠ ÙØ§ØµÙ„ Ø²Ù…Ù†ÙŠ Ø³Ø§Ø¨Ù‚
        if (intervalId) clearInterval(intervalId);

        // Ø¨Ø¯Ø¡ ÙØ§ØµÙ„ Ø²Ù…Ù†ÙŠ Ø¬Ø¯ÙŠØ¯
        intervalId = setInterval(() => {
          if (autoPlay) showNext();
        }, 20000);
      }

      // Ø¯Ø§Ù„Ø© ØªØ¨Ø¯ÙŠÙ„ Ø­Ø§Ù„Ø© Ø§Ù„Ø¹Ø±Ø¶ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ
      function toggleAuto() {
        autoPlay = !autoPlay;
        autoBtn.textContent = autoPlay
          ? "Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ø¹Ø±Ø¶ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ"
          : "ØªØ´ØºÙŠÙ„ Ø§Ù„Ø¹Ø±Ø¶ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ";
      }

      // Ø¯Ø§Ù„Ø© Ø¹Ø±Ø¶ Ù‚Ø§Ù„Ø¨ Ø§Ù„Ù…Ù„Ù
      function showTemplate(e) {
        e.preventDefault();
        templateModal.style.display = "block";
      }

      // Ø¯Ø§Ù„Ø© Ø¥ØºÙ„Ø§Ù‚ Ù‚Ø§Ù„Ø¨ Ø§Ù„Ù…Ù„Ù
      function closeTemplate() {
        templateModal.style.display = "none";
      }

      // Ø¯Ø§Ù„Ø© Ø¹Ø±Ø¶ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„ØªØ®ØµÙŠØµ
      function showSettings(e) {
        e.preventDefault();

        // ØªØ¹Ø¨Ø¦Ø© Ø§Ù„Ù‚ÙŠÙ… Ø§Ù„Ø­Ø§Ù„ÙŠØ©
        groupNameInput.value = groupColumnName;
        mottoInput.value = motto;

        settingsModal.style.display = "block";
      }

      // Ø¯Ø§Ù„Ø© Ø¥ØºÙ„Ø§Ù‚ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„ØªØ®ØµÙŠØµ
      function closeSettings() {
        settingsModal.style.display = "none";
      }

      // Ø¯Ø§Ù„Ø© Ø­ÙØ¸ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„ØªØ®ØµÙŠØµ
      function saveSettings() {
        // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ù‚ÙŠÙ… Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
        const newGroupName = groupNameInput.value.trim() || "Ø§Ù„Ø­Ù„Ù‚Ø©";
        const newMotto =
          mottoInput.value.trim() ||
          "Ù‡Ù†Ø§ ÙŠØªÙ„Ù‰ Ø§Ù„Ù‚Ø±Ø¢Ù† .. Ùˆ ÙŠÙ†Ø³Ø¬ Ø§Ù„Ù…Ø¬Ø¯ Ø­Ø±ÙØ§Ù‹ Ø­Ø±ÙØ§Ù‹";

        // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª
        groupColumnName = newGroupName;
        motto = newMotto;

        // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ø¨Ø§Ø±Ø© Ø§Ù„Ø¥ÙŠÙ‚ÙˆÙ†ÙŠØ©
        logoDiv.textContent = `" ${motto} "`;

        // ØªØ­Ø¯ÙŠØ« Ø£Ø³Ù…Ø§Ø¡ Ø§Ù„Ø£Ø¹Ù…Ø¯Ø© ÙÙŠ Ø§Ù„Ù‚Ø§Ù„Ø¨
        groupColumnHeaders.forEach((header) => {
          header.textContent = groupColumnName;
        });

        // ØªØ­Ø¯ÙŠØ« Ø£Ù…Ø«Ù„Ø© Ø§Ù„Ø£Ø¹Ù…Ø¯Ø©
        const baseExample = groupColumnName + " ";
        groupColumnExamples.forEach((example, index) => {
          const num = Math.floor(index / 2) + 1;
          example.textContent = baseExample + num;
        });

        // Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª ÙÙŠ Ø§Ù„ØªØ®Ø²ÙŠÙ† Ø§Ù„Ù…Ø­Ù„ÙŠ
        localStorage.setItem(
          "studentScoreSettings",
          JSON.stringify({
            groupColumnName,
            motto,
          })
        );

        // Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù†Ø§ÙØ°Ø© ÙˆØ¹Ø±Ø¶ ØªÙ†Ø¨ÙŠÙ‡
        closeSettings();
        showAlert("ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø¨Ù†Ø¬Ø§Ø­", "success");

        // Ø¥Ø°Ø§ ÙƒØ§Ù† Ù‡Ù†Ø§Ùƒ Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø¹Ø±ÙˆØ¶Ø©ØŒ ØªØ­Ø¯ÙŠØ«Ù‡Ø§
        if (episodes.length > 0) {
          showCurrentGroup();
        }
      }

      // Ø¯Ø§Ù„Ø© ØªÙ†Ø²ÙŠÙ„ Ù‚Ø§Ù„Ø¨ Ø§Ù„Ù…Ù„Ù
      function downloadTemplate() {
        // Ø¥Ù†Ø´Ø§Ø¡ Ù…ØµÙÙˆÙØ© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ÙŠØ©
        const templateData = [
          [groupColumnName, "Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨", "Ø§Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø±ØµÙŠØ¯"],
          [groupColumnName + " 1", "Ø®Ø§Ù„Ø¯ Ù…Ø­Ù…Ø¯", 95],
          [groupColumnName + " 1", "Ø¹Ù„ÙŠ Ø£Ø­Ù…Ø¯", 85],
          [groupColumnName + " 1", "Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡ Ø³Ø¹ÙŠØ¯", 92],
          [groupColumnName + " 2", "Ø³Ø¹Ø¯ Ø®Ø§Ù„Ø¯", 87],
          [groupColumnName + " 2", "Ù…Ø­Ù…Ø¯ Ø¹Ù„ÙŠ", 91],
          [groupColumnName + " 3", "ÙÙ‡Ø¯ Ù†Ø§ØµØ±", 88],
          [groupColumnName + " 3", "Ø¹Ù…Ø± Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡", 94],
        ];

        // Ø¥Ù†Ø´Ø§Ø¡ ÙˆØ±Ù‚Ø© Ø¹Ù…Ù„
        const worksheet = XLSX.utils.aoa_to_sheet(templateData);

        // Ø¥Ù†Ø´Ø§Ø¡ Ù…ØµÙ†Ù Ø¹Ù…Ù„
        const workbook = XLSX.utils.book_new();
        XLSX.utils.book_append_sheet(workbook, worksheet, "Ø±ØµÙŠØ¯ Ø§Ù„Ù†Ù‚Ø§Ø·");

        // ØªÙ†Ø²ÙŠÙ„ Ø§Ù„Ù…Ù„Ù
        XLSX.writeFile(workbook, `Ù†Ù…ÙˆØ°Ø¬_Ø±ØµÙŠØ¯_Ø§Ù„Ù†Ù‚Ø§Ø·.xlsx`);
      }

      // Ø¯Ø§Ù„Ø© Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
      function resetApplication() {
        // Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ø¹Ø±Ø¶ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ
        if (intervalId) {
          clearInterval(intervalId);
          intervalId = null;
        }

        // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª
        groups = {};
        episodes = [];
        currentIndex = 0;
        autoPlay = true;

        // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
        outputDiv.innerHTML = "";
        fileAlert.className = "alert";
        fileAlert.textContent = "";
        fileInput.value = ""; // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ù‚ÙŠÙ…Ø© Ø§Ù„Ù…Ù„Ù

        // Ø¥Ø¸Ù‡Ø§Ø± Ø®Ø§Ù†Ø© Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„Ù…Ù„Ù
        document.querySelector(".file-container").classList.remove("hidden");

        // Ø¥Ø®ÙØ§Ø¡ Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ­ÙƒÙ… ÙˆØ²Ø± Ø§Ù„Ø¥Ø¹Ø§Ø¯Ø©
        controlsDiv.classList.add("hidden");
        resetBtn.classList.add("hidden");

        // ØªØºÙŠÙŠØ± - Ø¥Ø®ÙØ§Ø¡ Ø²Ø± Ø§Ù„ØªØ®ØµÙŠØµ Ø¹Ù†Ø¯ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªØ¹ÙŠÙŠÙ†
        settingsBtn.classList.add("hidden");

        // ØªØ­Ø¯ÙŠØ« Ù†Øµ Ø²Ø± Ø§Ù„ØªØ´ØºÙŠÙ„ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ
        autoBtn.textContent = "Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ø¹Ø±Ø¶ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ";
      }

      // Ø¯Ø§Ù„Ø© Ø¹Ø±Ø¶ Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡
      function showAlert(message, type) {
        fileAlert.textContent = message;
        fileAlert.className = "alert";
        fileAlert.classList.add("alert-" + type);

        // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ø¨Ø¹Ø¯ 5 Ø«ÙˆØ§Ù†Ù Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø±Ø³Ø§Ù„Ø© Ù†Ø¬Ø§Ø­
        if (type === "success") {
          setTimeout(() => {
            fileAlert.className = "alert";
            fileAlert.textContent = "";
          }, 5000);
        }
      }

      // Ø¥ØºÙ„Ø§Ù‚ Ù†Ø§ÙØ°Ø© Ø§Ù„Ù‚Ø§Ù„Ø¨ Ø¹Ù†Ø¯ Ø§Ù„Ù†Ù‚Ø± Ø®Ø§Ø±Ø¬Ù‡Ø§
      window.onclick = function (event) {
        if (event.target === templateModal) {
          closeTemplate();
        }
        if (event.target === settingsModal) {
          closeSettings();
        }
      };

      // ØªØ­Ø³ÙŠÙ† ØªØ¬Ø±Ø¨Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
      window.addEventListener("load", function () {
        // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø¯Ø¹Ù… API File
        if (
          window.File &&
          window.FileReader &&
          window.FileList &&
          window.Blob
        ) {
          // Ø§Ù„Ù…Ù„ÙØ§Øª Ù…Ø¯Ø¹ÙˆÙ…Ø©
        } else {
          showAlert(
            "Ø®Ø·Ø£: Ù…ØªØµÙØ­Ùƒ Ù„Ø§ ÙŠØ¯Ø¹Ù… Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„Ù…Ù„ÙØ§Øª. ÙŠØ±Ø¬Ù‰ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù…ØªØµÙØ­ Ø­Ø¯ÙŠØ«.",
            "error"
          );
        }
      });
    </script>
  </body>
</html>
